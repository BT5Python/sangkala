<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Upload ke Google Drive</title>
<style>
  body { background:#000; color:#0f0; font-family:monospace; text-align:center; padding:40px; }
  button { padding:12px 25px; font-size:18px; background:#0f0; color:#000; border:0; cursor:pointer; }
  input[type=file]{ margin:20px; }

  #bar {
    width:300px;
    height:10px;
    background:#033;
    margin:20px auto;
    border-radius:5px;
    overflow:hidden;
    display:none;
  }
  #progress {
    height:100%;
    width:0%;
    background:#0f0;
  }
</style>
</head>
<body>

<h2>UPLOAD KE GOOGLE DRIVE</h2>

<input type="file" id="fileInput">
<button onclick="upload()">Upload</button>

<div id="bar"><div id="progress"></div></div>

<p id="status"></p>

<script>
const WEBAPP_URL = "PASTE_WEB_APP_URL_KAMU";

function animateProgress() {
  let p = 0;
  const bar = document.getElementById("bar");
  const pr = document.getElementById("progress");
  bar.style.display = "block";

  const timer = setInterval(() => {
    p += 2;
    if (p >= 95) { clearInterval(timer); }
    pr.style.width = p + "%";
  }, 50);
}

async function upload(){
  const file = document.getElementById("fileInput").files[0];
  if(!file) return alert("Pilih file dulu!");

  animateProgress();

  const reader = new FileReader();
  reader.onloadend = async () => {
    const base64 = reader.result.split(",")[1];

    const form = new URLSearchParams();
    form.append("name", file.name);
    form.append("type", file.type);
    form.append("file", base64);

    document.getElementById("status").innerText = "Uploading...";

    const res = await fetch(WEBAPP_URL, { method:"POST", body: form });
    const result = await res.json();

    document.getElementById("progress").style.width = "100%";

    if(result.status === "success"){
      document.getElementById("status").innerHTML =
        "✔ Uploaded: <a href='" + result.fileUrl + "' target='_blank'>Buka File</a>";
    } else {
      document.getElementById("status").innerText = "❌ Error: " + result.message;
    }
  };

  reader.readAsDataURL(file);
}
</script>

</body>
</html>

<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body{
      background:#000;
      color:#00ff00;
      font-family: Consolas, monospace;
      text-align:center;
      padding:40px;
    }
    .box{
      padding:40px;
      border:1px solid #00ff00;
      border-radius:14px;
      width:420px;
      margin:auto;
      background:#0a0a0a;
    }
    input[type=file]{
      padding:10px;
      border:1px solid #00ff00;
      border-radius:8px;
      width:100%;
      color:#00ff00;
      background:#000;
    }
    button{
      margin-top:20px;
      width:100%;
      padding:12px;
      border:none;
      border-radius:8px;
      background:#00ff00;
      color:#000;
      font-weight:bold;
      cursor:pointer;
      font-size:16px;
    }
    #progress{
      width:100%;
      height:14px;
      background:#333;
      margin-top:20px;
      border-radius:8px;
      overflow:hidden;
      display:none;
    }
    #progress-bar{
      width:0%;
      height:100%;
      background:#00ff00;
    }
    #status{
      margin-top:20px;
      font-size:14px;
      color:#00ff00;
      min-height:20px;
    }
  </style>
</head>

<body>
  <h2>UPLOAD FILE KE GOOGLE DRIVE</h2>

  <div class="box">
      <input type="file" id="file"><br>

      <button onclick="startUpload()">UPLOAD</button>

      <div id="progress">
        <div id="progress-bar"></div>
      </div>

      <div id="status"></div>
  </div>

<script>
function startUpload(){
  const file = document.getElementById("file").files[0];
  if(!file){
    alert("Pilih file dulu.");
    return;
  }

  document.getElementById("status").innerHTML = "Menyiapkan upload...";
  document.getElementById("progress").style.display = "block";

  const reader = new FileReader();
  reader.onload = function(e){
      const base64 = e.target.result.split(',')[1];

      animateProgress();

      google.script.run.withSuccessHandler(res => {
          if(res.status === "success"){
            document.getElementById("status").innerHTML =
              "✔ " + res.fileName + " berhasil diupload";
          } else {
            document.getElementById("status").innerHTML = "❌ Error: " + res.message;
          }
      }).uploadToDrive({
        fileName: file.name,
        mimeType: file.type,
        base64: base64
      });
  };
  reader.readAsDataURL(file);
}

// Fake progress animation
function animateProgress(){
  let bar = document.getElementById("progress-bar");
  let width = 0;
  let interval = setInterval(() => {
    if(width >= 100){
      clearInterval(interval);
    } else {
      width += 5;
      bar.style.width = width + "%";
    }
  }, 80);
}
</script>

</body>
</html>
